require 'rails_helper'

RSpec.describe 'User index page', type: :system do
  let!(:users) { create_list(:user, 3) }

  it 'displays user information' do
    visit users_path

    users.each do |user|
      expect(page).to have_content(user.username)
      expect(page).to have_css("img[src*='#{user.profile_picture.url}']")
      expect(page).to have_content(user.posts.count)
    end
  end

  it 'redirects to user show pages' do
    users.each do |user|
      visit users_path
      click_link user.username
      expect(current_path).to eq(user_path(user))
    end
  end
end

